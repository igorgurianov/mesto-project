(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{VQ:()=>w,kH:()=>O,Np:()=>B});var e=document.querySelector(".cards-grid"),o=document.querySelector("#card-template").content;function n(t,e,n,c,a,i){var u=o.querySelector(".place").cloneNode(!0),s=u.querySelector(".place__photo"),p=u.querySelector(".place__like-button");return"a9b2e44f4010ebf34559bc45"==c?u.querySelector(".place__delete-button").addEventListener("click",(function(t){return function(t,e){(function(t){fetch("https://nomoreparties.co/v1/plus-cohort-19/cards/".concat(t),{method:"DELETE",headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42"}}).then((function(t){if(!t.ok)return Promise.reject("Ошибка при удалении карточки: ".concat(t.status))}))})(e),t.target.closest(".place").remove()}(t,a)})):u.querySelector(".place__delete-button").remove(),u.querySelector(".place__like-counter").textContent=n,u.querySelector(".place__name").textContent=t,s.src=e,s.alt=t,s.addEventListener("click",(function(){w(e,t)})),p.addEventListener("click",(function(t){return function(t,e){t.target.classList.contains("place__like-button_active")?(console.log("было активно, можем снять"),function(t,e){fetch("https://nomoreparties.co/v1/plus-cohort-19/cards/likes/".concat(e),{method:"DELETE",headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42"}}).then((function(t){return t.json()})).then((function(e){r(t,e)}))}(t,e)):function(t,e){fetch("https://nomoreparties.co/v1/plus-cohort-19/cards/likes/".concat(e),{method:"PUT",headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42"}}).then((function(t){if(t.ok)return t.json();Promise.reject(t)})).then((function(e){r(t,e)}))}(t,e),t.target.classList.toggle("place__like-button_active")}(t,a)})),i.forEach((function(t){"a9b2e44f4010ebf34559bc45"==t._id&&p.classList.add("place__like-button_active")})),u}function c(t){e.prepend(t)}function r(t,e){t.target.nextElementSibling.textContent="".concat(e.likes.length)}function a(t){"Escape"===t.key&&i(document.querySelector(".popup_opened"))}function i(t){t.classList.remove("popup_opened"),document.removeEventListener("keydown",a)}function u(t){t.classList.add("popup_opened"),document.addEventListener("keydown",a)}function s(t,e,o){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.classList.remove("".concat(o.inactiveButtonClass)),e.disabled=!1):(e.classList.add("".concat(o.inactiveButtonClass)),e.disabled=!0)}fetch("https://nomoreparties.co/v1/plus-cohort-19/cards",{headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){t.forEach((function(t){c(n(t.name,t.link,t.likes.length,t.owner._id,t._id,t.likes))}))})).catch((function(t){console.log("Ошибка при загрузке карточек: ".concat(t.status))}));var p,l=document.querySelectorAll(".popup"),d=document.querySelectorAll(".popup__close-button"),f=document.querySelector(".profile__edit-button"),_=document.querySelector(".profile__add-button"),m=document.querySelector(".profile__avatar-button"),h=document.querySelector(".popup__input-container_type_add"),y=document.querySelector(".popup__text-input_type_card-name"),v=document.querySelector(".popup__text-input_type_link"),b=document.querySelector(".profile__name"),S=document.querySelector(".profile__description"),q=document.querySelector(".popup_type_add_card"),k=document.querySelector(".popup_type_edit-profile"),E=document.querySelector(".popup__input-container_type_profile"),L=E.querySelector(".popup__text-input_type_name"),g=E.querySelector(".popup__text-input_type_description"),C=document.querySelector(".profile__avatar"),x=document.querySelector(".popup_type_edit-avatar"),j=document.querySelector(".popup__input-container_type_avatar"),P=j.querySelector(".popup__text-input_type_avatar"),T=document.querySelector(".popup_type_image"),z=T.querySelector(".popup__label"),A=document.querySelector(".popup__image");function O(t,e){t.target.querySelector(".popup__submit").textContent=e?"Сохранение...":"Создать"}function w(t,e){u(T),A.src=t,A.alt=e,z.textContent=e}function B(t){C.src=t.avatar,b.textContent=t.name,S.textContent=t.about}p={formSelector:".popup__input-container",inputSelector:".popup__text-input",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__submit_inactive",inputErrorClass:"popup__text-input_type_error",errorClass:"popup__input-error_active"},Array.from(document.querySelectorAll("".concat(p.formSelector))).forEach((function(t){!function(t,e){var o=Array.from(t.querySelectorAll("".concat(e.inputSelector))),n=t.querySelector("".concat(e.submitButtonSelector));s(o,n,e),o.forEach((function(c){c.addEventListener("input",(function(){!function(t,e,o){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?function(t,e,o){var n=t.querySelector(".".concat(e.id,"-error"));e.classList.remove("".concat(o.inputErrorClass)),n.classList.remove("".concat(o.errorClass)),n.textContent=""}(t,e,o):function(t,e,o,n){var c=t.querySelector(".".concat(e.id,"-error"));e.classList.add("".concat(n.inputErrorClass)),c.classList.add("".concat(n.errorClass)),c.textContent=o}(t,e,e.validationMessage,o)}(t,c,e),s(o,n,e)}))}))}(t,p)})),fetch("https://nomoreparties.co/v1/plus-cohort-19/users/me",{headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42"}}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){B(t)})).catch((function(t){return console.log("Ошибка при получении данных пользователя: ".concat(t.status))})),j.addEventListener("submit",(function(t){var e,o;t.preventDefault(),O(t,!0),e=P.value,o=t,fetch("https://nomoreparties.co/v1/plus-cohort-19/users/me/avatar",{method:"PATCH",headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42","Content-Type":"application/json"},body:JSON.stringify({avatar:"".concat(e)})}).then((function(t){return t.json()})).then((function(t){B(t)})).finally((function(){O(o,!1)})),i(x),j.reset(),t.submitter.classList.add("popup__submit_inactive"),t.submitter.disabled=!0})),h.addEventListener("submit",(function(t){t.preventDefault(),O(t,!0),function(t,e,o){fetch("https://nomoreparties.co/v1/plus-cohort-19/cards",{method:"POST",headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42","Content-Type":"application/json"},body:JSON.stringify({name:"".concat(t),link:"".concat(e)})}).then((function(t){return t.ok?t.json():Promise.reject()})).then((function(t){c(n(t.name,t.link,t.likes.length,t.owner._id,t._id,t.likes))})).catch((function(t){return console.log("Ошибка при добавлении новой карточки: ".concat(t.status))})).finally((function(){O(o,!1)}))}(y.value,v.value,t),i(q),h.reset(),t.submitter.classList.add("popup__submit_inactive"),t.submitter.disabled=!0})),E.addEventListener("submit",(function(t){t.preventDefault(),O(t,!0),function(t,e,o){fetch("https://nomoreparties.co/v1/plus-cohort-19/users/me",{method:"PATCH",headers:{authorization:"a2c97fba-80a7-48e7-83f6-eccca0540f42","Content-Type":"application/json"},body:JSON.stringify({name:"".concat(t),about:"".concat(e)})}).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){B(t)})).catch((function(t){console.log("Ошибка при обновлении информации о пользователе: ".concat(t.status))})).finally((function(){O(o,!1)}))}("".concat(L.value),"".concat(g.value),t),i(k),t.submitter.classList.add("popup__submit_inactive"),t.submitter.disabled=!0})),m.addEventListener("click",(function(){u(x)})),f.addEventListener("click",(function(){u(k),L.value=b.textContent,g.value=S.textContent})),_.addEventListener("click",(function(){u(q)})),d.forEach((function(t){var e=t.closest(".popup");t.addEventListener("click",(function(){i(e)}))})),l.forEach((function(t){t.addEventListener("mousedown",(function(t){t.target.classList.contains("popup")&&i(t.target)}))}))})();